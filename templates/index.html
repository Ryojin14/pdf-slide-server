<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PDF to VRChat Slide</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #0f0f0f; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { text-align: center; border: 2px dashed #444; padding: 40px; border-radius: 20px; width: 420px; background: #1a1a1a; transition: 0.3s; }
        /* ë“œë˜ê·¸ ì¤‘ì¼ ë•Œ ë””ìì¸ ë³€ê²½ */
        .container.dragover { background: #222; border-color: #00ff88; transform: scale(1.02); }
        #loading { display: none; margin-top: 20px; color: #00ff88; font-weight: bold; }
        .btn { background: #00ff88; color: black; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 20px; width: 100%; }
        #result-box { display: none; margin-top: 30px; padding: 20px; background: #222; border-radius: 10px; border: 1px solid #333; animation: fadeIn 0.5s; }
        .url-text { word-break: break-all; color: #00ff88; font-family: monospace; font-size: 13px; margin-bottom: 15px; display: block; background: #000; padding: 10px; border-radius: 5px; }
        .copy-btn { background: #444; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; width: 100%; font-size: 13px; font-weight: bold; }
        .copy-btn:hover { background: #555; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="container" id="drop-zone">
        <h1>PDF ìŠ¬ë¼ì´ë“œ ë³€í™˜ê¸°</h1>
        <p id="status-msg" style="color: #888;">PDF íŒŒì¼ì„ ì—¬ê¸°ë¡œ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
        
        <input type="file" id="file-input" style="display: none;" accept="application/pdf">
        <button class="btn" id="select-btn">íŒŒì¼ ì„ íƒ ë° ì—…ë¡œë“œ</button>
        
        <div id="loading">ğŸš€ ë³€í™˜ ë° ì—…ë¡œë“œ ì¤‘...<br>(ìµœëŒ€ 1ë¶„ ì†Œìš”)</div>

        <div id="result-box">
            <h3 style="margin-top: 0;">âœ… ìƒì„± ì™„ë£Œ!</h3>
            <span id="video-url" class="url-text"></span>
            <button class="copy-btn" onclick="copyUrl()">ì£¼ì†Œ ë³µì‚¬í•˜ê¸°</button>
            <p style="font-size: 11px; color: #666; margin-top: 10px;">ë³µì‚¬í•œ ì£¼ì†Œë¥¼ VRChat URL ì¹¸ì— ë„£ìœ¼ì„¸ìš”!</p>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const selectBtn = document.getElementById('select-btn');

        // 1. í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
        selectBtn.onclick = () => fileInput.click();
        fileInput.onchange = (e) => handleUpload(e.target.files[0]);

        // 2. ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì¸í„°ë™ì…˜
        dropZone.ondragover = (e) => { e.preventDefault(); dropZone.classList.add('dragover'); };
        dropZone.ondragleave = () => { dropZone.classList.remove('dragover'); };
        dropZone.ondrop = (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            handleUpload(e.dataTransfer.files[0]);
        };

        // 3. íŒŒì¼ ì—…ë¡œë“œ ë¡œì§
        function handleUpload(file) {
            if (!file || file.type !== 'application/pdf') { alert('PDF íŒŒì¼ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤!'); return; }

            const formData = new FormData();
            formData.append('pdf_file', file);

            document.getElementById('loading').style.display = 'block';
            document.getElementById('result-box').style.display = 'none';
            document.getElementById('status-msg').innerText = "íŒŒì¼ ì²˜ë¦¬ ì¤‘...";

            fetch('/upload', { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                document.getElementById('loading').style.display = 'none';
                if (data.video_url) {
                    document.getElementById('result-box').style.display = 'block';
                    document.getElementById('video-url').innerText = data.video_url;
                    document.getElementById('status-msg').innerText = "ì—…ë¡œë“œ ì™„ë£Œ!";
                } else {
                    alert('ì—ëŸ¬ ë°œìƒ: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    document.getElementById('status-msg').innerText = "ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                }
            });
        }

        // 4. ì£¼ì†Œ ë³µì‚¬ ê¸°ëŠ¥
        function copyUrl() {
            const url = document.getElementById('video-url').innerText;
            navigator.clipboard.writeText(url).then(() => {
                alert('ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! VRChatìœ¼ë¡œ ê°€ì„¸ìš”!');
            });
        }
    </script>
</body>
</html>